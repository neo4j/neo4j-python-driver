#!/usr/bin/env bash
set -e

ROOT=$(dirname "$0")/..
SCRIPT=$(basename "$0")
DIST="${ROOT}/dist"
STATUS=0

VERSION="$1"
if [ "${VERSION}" == "" ]; then
    echo "usage: ${SCRIPT} VERSION"
    exit 1
fi

source "${ROOT}/bin/dist-functions"

load_dist_files "${VERSION}"
if [ "${#DIST_FILES[@]}" -eq 0 ]; then
    echo "No distributions found, aborting"
    exit 1
fi
twine check --strict "${DIST_FILES[@]}"
if [ "${#DIST_FILES[@]}" -ne 113 ]; then
    echo "Some distributions are missing, aborting"
    exit 1
fi
